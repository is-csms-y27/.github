# Лабораторная 2

Для каждого задания необходимо создавать отдельный проект в соответствующей solution папке.

## Задание 1

### Отрабатываемый материал

Http, Refit

### Задача

Реализовать клиент для внешнего сервиса конфигураций, позволяющий выгрузку элементов конфигураций.

Реализация стороннего сервиса конфигураций находится в
репозитории [lab-2-tools](https://github.com/is-csms-y27/lab-2-tools), данный сервис заранее собран в Docker образ,
также в репозитории вы можете
найти [docker-compose](https://github.com/is-csms-y27/lab-2-tools/blob/master/docker-compose.yaml) файл, который
разворачивает сам сервис и базу данных для него. Вам необходимо скопировать этот файл в папку `scr/lab-2` вашего
репозитория и добавить его в solution папку `src/lab-2`. Данный сервис имеет Swagger документацию (по пути `/swagger`)
которую вы можете использовать для сидинга данных в сервис.

### Функциональные требования

- Реализация должна содержать [основной] интерфейс, позволяющий выгрузить все конфигурации из сервиса

### Нефункциональные требования

- Вам необходимо сделать две реализации – одну с ручной реализацией запросов, другую с использованием Refit
- Выгрузка конфигураций должна происходить пагинированно
- Основной интерфейс не должен зависеть от Refit
- Размер выгружаемой страницы должен параметризироваться
- В ручной реализации `HttpClient` должен получаться при помощи `IHttpClientFactory`
- Реализация должна содержать экстеншен методы для регистрации в DI обеих реализаций (два отдельных метода)

## Задание 2

### Отрабатываемый материал

Microsoft.Extensions.Configuration, ConfigurationProvider

### Задача

Реализовать кастомный ConfigurationProvider, который будет получать и отдавать конфигурации из сервиса Задания 1.

### Нефункциональные требования

- Вам необходимо реализовать сервис, обслуживающий провайдер, получающий конфигурации из клиента и отправляющий их в
  провайдер на обработку
- Сам провайдер не должен реализовывать какие-либо походы в клиенты
- Обслуживающий сервис должен предоставлять метод, обновляющий конфигурации раз в какой-то промежуток (для этого можно
  использовать класс PeriodicTimer)
- Промежуток обновления конфигураций должен быть параметризуем
- Провайдер не должен перезагружать конфигурации, если в них не было изменений

### Тестовые сценарии

#### Сценарий 1

**Arrange**: провайдер не имеет каких-либо ключей конфигураций
**Act**: провайдеру передают элемент конфигурации
**Assert**: провайдер содержит единственную пару ключ-значение, соответсвующую переданному элементу и обновляет
конфигурацию

#### Сценарий 2

**Arrange**: провайдер содержит единственную пару ключ-значение
**Act**: провайдеру передают такой же элемент конфигурации
**Assert**: провайдер не вызвал обновление конфигурации

#### Сценарий 3

**Arrange**: провайдер содержит единственную пару ключ-значение
**Act**: провайдеру передают элемент с таким же ключом, но изменённым значением
**Assert**: провайдер обновляет значение по ключу, и обновляет конфигурацию

#### Сценарий 4

**Arrange**: провайдер содержит единственную пару ключ-значение
**Act**: провайдеру передают пустую коллекцию конфигураций
**Assert**: провайдер становится пустым и обновляет конфигурацию

> для проверок того, обновил ли провайдер конфигурацию, вы можете посмотреть реализацию метода `OnReload` и какие данные
> он меняет

## Задание 3

### Отрабатываемый материал

Microsoft.Extensions.Options

Реализовать консольное приложение, позволяющее выводить различную информацию:

- FIGlet текст
- Изображение из Base64
- Изображение по URL


### Функциональные требования

- Отображаемый контент должен меняться динамически при смене конфигурации во внешнем сервисе

### Нефункциональные требования

- Конфигурация должна прокидываться в отрисовщик через Options
- Для реализации графической части можно воспользоваться библиотекой Spectre.Console
  - https://spectreconsole.net/widgets/figlet
  - https://spectreconsole.net/widgets/canvas-image
